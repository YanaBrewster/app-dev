$(document).ready(function(){var e;function o(e){document.getElementById("memberName").innerHTML='<h1 class="d-block text-center mt-4 mb-5">'+e+"'s Account </h1>"}function t(e){document.getElementById("artsDeck").innerHTML=e.map(e=>`<div class="col-sm-12 col-md-6 col-lg-4 my-xs-1 my-sm-1 my-md-3 my-lg-3">\n                                                                        <div class="card card-border rounded-0 mb-4">\n                                                                            <img src="${e.image}" id="${e._id}" alt="Avatar" class="card-img-top radius viewMoreButton">\n                                                                            <div class="card-body artcard-body mx-1 my-1">\n                                                                                <div class="artcard-columnwrap">\n                                                                                    <h4 class="card-title mb-3">${e.title}</h4>\n                                                                                    <h5 class="card-title artcard-price">&dollar;${e.price}</h5>\n                                                                                </div>\n                                                                                <p class="card-title"><b> <a href="${e.authorInfo.website}" class="card-link artcard-link">${e.authorInfo.username}</a>, ${e.authorInfo.location}</b></p>\n                                                                                <p class="mb-3 text-truncate">${e.description}</p>\n                                                                                <div class="artcard-columnwrap mt-4">\n                                                                                    <p class="card-title h5-cyan">${e.category}</p>\n                                                                                    <div class="button viewMoreButton btn-font" id="${e._id}">View</div>\n                                                                                </div>\n                                                                            </div>\n                                                                        </div>\n                                                                    </div>`).join(" ");let o=document.getElementsByClassName("viewMoreButton");for(let e=0;e<o.length;e++)o[e].addEventListener("click",n)}function n(o){let t=o.target.id;$.ajax({url:`${e}/portfolioWithAuthor/${t}`,type:"GET",dataType:"json",success:function(e){!function(e){let o,t,n=sessionStorage.getItem("username");o=e.comments.map(function(e){return n&&e.postByUsername===n?`<div class="col-sm-12 col-lg-12 col-md-10">\n                                                            <div class="comment-container comment-right mb-3">\n                                                                <div class="comment-info">\n                                                                    <strong class="mr-1">You</strong>\n                                                                    <p>on ${a(e.posted)}</p>\n                                                                </div>\n                                                                <p><b>${e.text}</b></p>\n                                                            </div>\n                                                        </div>`:e.postByUsername!==n?`<div class="col-sm-12 col-lg-12 col-md-10">\n                                                            <div class="comment-container comment-left mb-3">\n                                                                <div class="comment-info">\n                                                                    <strong class="mr-1">${e.postByUsername}</strong>\n                                                                    <p>on ${a(e.posted)}</p>\n                                                                </div>\n                                                                <p>${e.text}</p>\n                                                            </div>\n                                                        </div>`:void 0}).join(" "),t=n?'<div class="col-12 col-sm-12 col-lg-10 col-md-10 mx-auto">\n                                        <label for="viewMorePage-postComment"\n                                              class="nav-font">\n                                              Comment:\n                                        </label>\n                                        <textarea id="viewMorePage-postComment"\n                                                  class="col-12 col-sm-12 col-lg-10 col-md-10"\n                                                  rows="4"\n                                                  cols="100">\n                                        </textarea>\n                                        <div class="col-12 col-sm-12 col-lg-11 col-md-11">\n                                            <div id="viewMorePage-postCommentButton"\n                                                class="button btn-font bg-dark float-right mt-2 mb-5">\n                                                Submit\n                                            </div>\n                                        </div>\n                                    </div>':'\n                                    <div class="text-center mb-5">Please log in to add comment</div>',document.getElementById("viewMorePage").innerHTML=`\n                                                        <div id="viewMorePage-artInfo">\n                                                            <h5 class="h3">${e.title}</h5>\n                                                            <div class="viewMore-photoBackground">\n                                                                <img src="${e.image}"\n                                                                    class="viewMore-mainPhoto img-fluid"\n                                                                    alt="${e.title} photo">\n                                                            </div>\n                                                            <div class="flexContainer-row mt-3 mb-3">\n                                                                <h5 class="h4">${e.authorInfo.username}</h5>\n                                                                <h5 class="card-title h4 artcard-price">&dollar;${e.price}</h5>\n                                                            </div>\n                                                            <p>${e.description}</p>\n                                                            <strong class="mb-5">Location: ${e.authorInfo.location}</strong>\n                                                            <br/>\n                                                            <a href="${e.authorInfo.website}"\n                                                              class="artcard-link">\n                                                              ${e.authorInfo.website}\n                                                            </a>\n                                                            <div class="artcard-columnwrap mt-5 viewMore-endBoarder">\n                                                                <p class="card-title h5-cyan">${e.category}</p>\n                                                                <div id="${e._id}"\n                                                                    class="bg-info text-white radius py-2 px-3 btn-font">\n                                                                    Buy Now\n                                                                </div>\n                                                            </div>\n                                                            <button id="backToLanding"\n                                                                    type="button"\n                                                                    class="btn btn-dark mt-3 mb-5 btn-font radius">\n                                                                    Back\n                                                            </button>\n                                                        </div>\n                                                        <div class="bg-light pt-5">\n                                                            <div class="row mx-auto">\n                                                                <div class="col-12 mb-5">\n                                                                    <h5 class="text-center">\n                                                                        Questions About This Artwork\n                                                                    </h5>\n                                                                </div>\n                                                                <div class="col-sm-12 col-md-8 mx-auto">\n                                                                    <div id="viewMorePage-comments"\n                                                                        class="mb-5">\n                                                                        ${o}\n                                                                    </div>\n                                                                </div>\n                                                            </div>\n\n                                                            <div class="row mx-auto">\n                                                                <div class="col-12 mb-4 mt-3">\n                                                                    <h5 class="text-center">\n                                                                        Ask the Artist a Question\n                                                                    </h5>\n                                                                </div>\n                                                                <div id="viewMorePage-addCommentWrapper"\n                                                                    class="row mx-auto">\n                                                                    ${t}\n                                                                </div>\n                                                            </div>\n                                                        </div>`,$("html, body").animate({scrollTop:0},"fast"),document.getElementById("backToLanding").addEventListener("click",function(){$("#viewMorePage").hide(),$("#landingPage").show(),sessionStorage.removeItem("currentPortfolio")}),document.getElementById("viewMorePage").contains(document.getElementById("viewMorePage-postCommentButton"))&&document.getElementById("viewMorePage-postCommentButton").addEventListener("click",i)}(e[0]),sessionStorage.setItem("currentPortfolio",e[0]._id),$("#viewMorePage").show(),$("#projectPage").hide(),$("#landingPage").hide(),0!==e[0].comments.length||(document.getElementById("viewMorePage-comments").innerHTML='<div id="noCommentNote"\n                                                                                  class="text-center">\n                                                                                  There has not been any question about this artwork</div>')},error:function(e){console.log("Error: "+e)}})}function i(){let o=$("textarea#viewMorePage-postComment").val(),t=Date.now(),n=sessionStorage.getItem("currentPortfolio"),i=sessionStorage.getItem("memberId"),r=sessionStorage.getItem("username");$.ajax({url:`${e}/addComment`,type:"POST",data:{portfolioID:n,postByID:i,postByUsername:r,postDate:t,content:o},success:function(e){$("textarea#viewMorePage-postComment").val(""),function(e){let o=`\n                      <div class="col-sm-12 col-lg-12 col-md-10">\n                          <div class="comment-container comment-right mb-3">\n                              <div class="comment-info">\n                                  <strong class="mr-1">You</strong>\n                                  <p>on ${a(e.posted)}</p>\n                              </div>\n                              <p><b>${e.text}</b></p>\n                          </div>\n                      </div>`,t=document.getElementById("viewMorePage-comments"),n=document.getElementById("noCommentNote");t.contains(n)&&n.remove();document.getElementById("viewMorePage-comments").innerHTML+=o}(e)},error:function(e){console.log(e)}})}function a(e){let o=new Date(e);return`${o.getDate()}/${o.getMonth()}/${o.getFullYear()} at ${o.getHours()}:${(o.getMinutes()<10?"0":"")+o.getMinutes()}`}function r(){let o=sessionStorage.getItem("memberId");o&&$.ajax({url:`${e}/myPortfolios/${o}`,type:"GET",success:function(e){var o;"No portfolio by this user found"!==e?(o=e,document.getElementById("myProjectCards").innerHTML=o.map(e=>`<div class="card\n                                                                                    portfolioCard\n                                                                                    border-bottom">\n                                                                            <div style="background-image:url(${e.image})"\n                                                                                class="portfolioPage-image"></div>\n                                                                            <h5 class="portfolioPage-cardTitle\n                                                                                      card-text mb-3">\n                                                                                      ${e.title}</h5>\n                                                                            <div id="portfolioCard__buttonWrapper${e._id}"\n                                                                                class="row mb-2">\n                                                                                <div class="col-sm-12\n                                                                                            col-md-4\n                                                                                            col-lg-4">\n                                                                                    <div id="${e._id}"\n                                                                                        class="button\n                                                                                                viewMoreButton\n                                                                                                btn-font\n                                                                                                mb-3">\n                                                                                                View</div>\n                                                                                </div>\n                                                                                <div class="col-sm-12\n                                                                                            col-md-4\n                                                                                            col-lg-4">\n                                                                                    <div id="edit${e._id}"\n                                                                                        class="editButton\n                                                                                                btn-dark\n                                                                                                btn-font\n                                                                                                radius\n                                                                                                py-2\n                                                                                                px-2\n                                                                                                mb-3">\n                                                                                                Edit</div>\n                                                                                </div>\n                                                                                <div class="col-sm-12\n                                                                                            col-md-4\n                                                                                            col-lg-4">\n                                                                                    <div id="delete${e._id}"\n                                                                                        class="deleteButton\n                                                                                                btn-red radius\n                                                                                                px-3 py-2\n                                                                                                mb-3\n                                                                                                btn-font\n                                                                                                float-lg-right">\n                                                                                                Delete</div>\n                                                                                </div>\n                                                                            </div>\n                                                                        </div>`).join(" "),function(){let e=document.getElementsByClassName("viewMoreButton");for(let o=0;o<e.length;o++)e[o].addEventListener("click",n)}()):document.getElementById("myProjectCards").innerHTML='<div class="noPortfolio text-center">You have not uploaded a project yet</div>'},error:function(e){console.log(e)}})}$("html, body").animate({scrollTop:0},"fast"),$.ajax({url:"config.json",type:"GET",dataType:"json",success:function(o){e=o.SERVER_URL+":"+o.SERVER_PORT,$.ajax({url:`${e}/portfoliosAndAuthors`,type:"GET",dataType:"json",success:function(e){t(e)},error:function(e){console.log("Error: "+e)}})},error:function(){console.log("error: cannot call api")}}),sessionStorage.usersName?($("#logoutBtn").show(),$(".home-btn").show(),$("#myPortfolioBtn").show(),$("#loginBtn").hide(),$("#signUpBtn").hide(),o(sessionStorage.usersName),$("#landingPage").show(),$("#viewMorePage").hide(),$("#loginPage").hide(),$("#signUpPage").hide(),$("#projectPage").hide(),$("#uploadPortfolioPage").hide(),$("#updatePortfolioPage").hide(),$("#deletePortfolioPage").hide()):($("#logoutBtn").hide(),$("#myPortfolioBtn").hide(),$(".home-btn").show(),$("#loginBtn").show(),$("#signUpBtn").show(),$("#landingPage").show(),$("#viewMorePage").hide(),$("#loginPage").hide(),$("#signUpPage").hide(),$("#projectPage").hide(),$("#uploadPortfolioPage").hide(),$("#updatePortfolioPage").hide(),$("#deletePortfolioPage").hide()),$(".home-btn").click(function(){$("#landingPage").show(),$("#viewMorePage").hide(),$("#loginPage").hide(),$("#signUpPage").hide(),$("#projectPage").hide(),$("#uploadPortfolioPage").hide(),$("#updatePortfolioPage").hide(),$("#deletePortfolioPage").hide()}),$("#loginBtn").click(function(){$("#loginPage").show(),$("#landingPage").hide(),$("#viewMorePage").hide(),$("#signUpPage").hide(),$("#projectPage").hide(),$("#uploadPortfolioPage").hide(),$("#updatePortfolioPage").hide(),$("#deletePortfolioPage").hide()}),$("#signUpBtn").click(function(){$("#signUpPage").show(),$("#projectPage").hide(),$("#loginPage").hide(),$("#landingPage").hide(),$("#viewMorePage").hide(),$("#uploadPortfolioPage").hide(),$("#updatePortfolioPage").hide(),$("#deletePortfolioPage").hide()}),$("#myPortfolioBtn").click(function(){r(),function(){let o=sessionStorage.getItem("memberId");if(!o)return;$.ajax({url:`${e}/myAccountInfo/${o}`,type:"GET",dataType:"json",success:function(e){!function(e){let o=e.about?e.about:"",t=e.website?e.website:"",n=e.location?e.location:"";document.getElementById("memberAccount").innerHTML=`<div class="flexContainer-flexStart mb-1">\n                <strong class="userInfoField">Username:</strong>\n                <div>${e.username}</div>\n            </div>\n            <div class="flexContainer-flexStart mb-1">\n                <strong class="userInfoField">Email:</strong>\n                <div>${e.email}</div>\n            </div>\n            <div class="flexContainer-flexStart mb-1">\n                <strong class="userInfoField">About:</strong>\n                <div>${o}</div>\n            </div>\n            <div class="flexContainer-flexStart mb-1">\n                <strong class="userInfoField">Location:</strong>\n                <div>${n}</div>\n            </div>\n            <div class="flexContainer-flexStart mb-1">\n                <strong class="userInfoField">Website:</strong>\n                <a>${t}</a>\n            </div>`}(e)},error:function(e){console.log(e)}})}(),$("#projectPage").show(),$("#signUpPage").hide(),$("#loginPage").hide(),$("#landingPage").hide(),$("#viewMorePage").hide(),$("#uploadPortfolioPage").hide(),$("#updatePortfolioPage").hide(),$("#deletePortfolioPage").hide()}),$("#addPortfolio").click(function(){$("#uploadPortfolioPage").show(),$("#projectPage").hide(),$("#signUpPage").hide(),$("#loginPage").hide(),$("#landingPage").hide(),$("#viewMorePage").hide(),$("#updatePortfolioPage").hide(),$("#deletePortfolioPage").hide()}),$(".back-portfolio").click(function(){$("#projectPage").show(),$("#uploadPortfolioPage").hide(),$("#signUpPage").hide(),$("#loginPage").hide(),$("#landingPage").hide(),$("#viewMorePage").hide(),$("#updatePortfolioPage").hide(),$("#deletePortfolioPage").hide()}),$("#updateProject").click(function(){$("#uploadPortfolioPage").hide(),$("#projectPage").hide(),$("#signUpPage").hide(),$("#loginPage").hide(),$("#landingPage").hide(),$("#viewMorePage").hide(),$("#updatePortfolioPage").show(),$("#deletePortfolioPage").hide()}),$("#deleteProject").click(function(){$("#uploadPortfolioPage").hide(),$("#projectPage").hide(),$("#signUpPage").hide(),$("#loginPage").hide(),$("#landingPage").hide(),$("#viewMorePage").hide(),$("#updatePortfolioPage").hide(),$("#deletePortfolioPage").show()}),$("#logoutBtn").click(function(){sessionStorage.clear(),$("#landingPage").show(),$("#loginPage").hide(),$("#signUpPage").hide(),$("#projectPage").hide(),$("#uploadPortfolioPage").hide(),$("#updatePortfolio").hide(),location.reload("#loginForm")}),$("#viewMembersBtn").click(function(){$.ajax({url:`${e}/allMembers`,type:"GET",dataType:"json",success:function(e){$("#membersCards").empty(),document.getElementById("membersCards").innerHTML+='<h2 class="pt-5 pb-4">All Members</h2>';for(let o=0;o<e.length;o++)document.getElementById("membersCards").innerHTML+=`<div class="col mt-3">\n          <h4> ${e[o].username}</h4>\n          </div>`},error:function(){}})}),$("#registerForm").submit(function(){event.preventDefault();let o=$("#registerUsername").val(),t=$("#registerEmail").val(),n=$("#registerPassword").val();$.ajax({url:`${e}/registerMember`,type:"POST",data:{username:o,email:t,password:n},success:function(e){"Members name is already taken. Please choose another name"!==e?(alert("Your account has been created, please login to activate your account"),$("#loginBtn").show(),$("#registerBtn").hide(),$("#loginPage").show(),$("#signUpPage").hide()):(alert("Username is already taken. Please try another one"),$("#registerUsername").val(""),$("#registerEmail").val(""),$("#registerPassword").val(""))},error:function(){}})}),$("#loginForm").submit(function(){event.preventDefault();let t=$("#inputUsernameLogin").val(),n=$("#inputPasswordLogin").val();$.ajax({url:`${e}/loginMember`,type:"POST",data:{username:t,password:n},success:function(e){" "===e?alert("Please fill in all input fields"):"Member not found. Please register"===e?alert("Register please"):"Not Authorized"===e?alert("Incorrect Password"):(sessionStorage.setItem("memberId",e._id),sessionStorage.setItem("username",e.username),sessionStorage.setItem("email",e.email),sessionStorage.setItem("location",e.location),sessionStorage.setItem("website",e.website),sessionStorage.setItem("about",e.about),o(t),$("#logoutBtn").show(),$("#myPortfolioBtn").show(),$("#loginBtn").hide(),$("#signUpBtn").hide(),$("#landingPage").show(),$("#loginPage").hide(),$("html, body").animate({scrollTop:0},"fast"))},error:function(){}})}),$("#addPortfolioForm").submit(function(){if(event.preventDefault(),!sessionStorage.memberId)return void alert("401, permission denied");let o=$("#addPortfolioTitle").val(),t=$("#addPortfolioDescription").val(),n=$("#addPortfolioImage").val(),i=$("#addPortfolioCategory").val(),a=$("#addPortfolioPrice").val(),s=sessionStorage.getItem("memberId");""==o||""==t||""==n||""==i||""==a?alert("Please enter all details"):$.ajax({url:`${e}/addPortfolio`,type:"POST",data:{title:o,description:t,image:n,category:i,price:a,memberId:s},success:function(e){"Artwork already added"!==e?alert("Artwork added to your portfolio"):alert("Title taken already, please try another one"),$("#addPortfolioTitle").val(),$("#addPortfolioDescription").val(),$("#addPortfolioImage").val(),$("#addPortfolioCategory").val(),$("#addPortfolioPrice").val(),$("#addPortfolioMemberId").val(),$("#addPortfolioForm").trigger("reset"),$("#uploadPortfolioPage").hide(),r(),$("#projectPage").show(),$("html, body").animate({scrollTop:50},"fast")},error:function(){}})}),document.getElementById("filterButton").addEventListener("click",function(){let o=JSON.parse($("#filterDropdown-byPrice").val()).min,n=JSON.parse($("#filterDropdown-byPrice").val()).max,i=$("#filterDropdown-byCategory").val();$.ajax({url:`${e}/filterPortfolios/${o}/${n}/${i}`,type:"GET",success:function(e){"Sorry, there is no artwork that matches your search!"===e?document.getElementById("artsDeck").innerHTML='\n                                                                <div class="row mx-auto">\n                                                                    <h5 class="text-center mt-5 mb-5">\n                                                                        Sorry, there is no artwork that matches your search!\n                                                                    </h5>\n                                                                </div>':t(e)},error:function(e){console.log("Error: "+e)}})})});